(this["webpackJsonpmeal-planner"]=this["webpackJsonpmeal-planner"]||[]).push([[0],{38:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(9),i=n.n(c),s=(n(38),n(11)),u=n(4),o=function(e,t){return e.length>t?e.substring(0,t)+"...":e},l=n(1),d=function(e){var t=e.meal,n=e.toggleModal,a=o;return Object(l.jsxs)("div",{onDragStart:function(e){e.dataTransfer.setData("text/plain",e.target.id),e.dataTransfer.dropEffect="move"},onClick:n,className:"meal-card",id:JSON.stringify(t),draggable:"true",children:[a(t.recipe_name,30),Object(l.jsx)("div",{className:"meal-card-body",children:Object(l.jsx)("span",{className:"meal-assigned-to",style:{backgroundColor:t.tag_color},children:t.assigned_to_name})})]})},p=n(3),j=n.n(p),f=n(6),b=n(5),h=n.n(b),m="http://localhost:3000/api/meals";h.a.defaults.withCredentials=!0;var v={getAll:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.a.get("".concat(m)),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.post("".concat(m),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(f.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.a.put("".concat(m,"/").concat(n),t),e.abrupt("return",a.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.delete("".concat(m,"/").concat(t)),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=n(13),O=n.n(g),x="http://localhost:3000/api/recipes",w={getAll:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.a.get("".concat(x)),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getIngredients:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.get("".concat(x,"/").concat(t,"/ingredients")),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),get:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.get("".concat(x,"/").concat(t)),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.post("".concat(x),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(f.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.a.put("".concat(x,"/").concat(t),n),e.abrupt("return",a.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.delete("".concat(x,"/").concat(t)),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y="http://localhost:3000/api/users";h.a.defaults.withCredentials=!0;var S={getAll:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.a.get("".concat(y)),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),get:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.get("".concat(y,"/").concat(t)),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.post("".concat(y),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(f.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.a.put("".concat(y,"/").concat(t),n),e.abrupt("return",a.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},k=function(e){var t=e.displayMessage,n=e.meal,r=e.meals,c=e.setMeals,i=e.weekdays,s=e.mealConfig,o=e.setIsOpen,d=Object(a.useState)(!!n.id),p=Object(u.a)(d,2),j=p[0],f=(p[1],Object(a.useState)("")),b=Object(u.a)(f,2),h=b[0],m=b[1],g=Object(a.useState)(""),O=Object(u.a)(g,2),x=O[0],y=O[1],k=Object(a.useState)([]),C=Object(u.a)(k,2),N=C[0],_=C[1],M=Object(a.useState)(""),I=Object(u.a)(M,2),P=I[0],E=I[1],R=Object(a.useState)(""),D=Object(u.a)(R,2),A=D[0],L=D[1],U=Object(a.useState)([]),J=Object(u.a)(U,2),T=J[0],q=J[1];return Object(a.useEffect)((function(){w.getAll().then((function(e){_(e),j?E(n.recipe_id):e.length>0&&E(e[0].id)})),m(n.day),y(n.meal?n.meal.value:n.type),S.getAll().then((function(e){q(e),j?L({id:n.assigned_to,first_name:n.assigned_to_name}):e.length>0&&L(e[0])}))}),[]),Object(l.jsx)("div",{className:"form-container",children:Object(l.jsxs)("div",{className:"form-wrapper",id:"meal-form-wrapper",children:[Object(l.jsx)("h2",{children:n.id?"Update meal":"Create new meal"}),Object(l.jsxs)("form",{className:"meal-form",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Weekday"}),Object(l.jsx)("select",{value:h,onChange:function(e){var t=e.target;return m(t.value)},children:i.map((function(e){return Object(l.jsx)("option",{value:e.value,children:e.label})}))})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Meal"}),Object(l.jsx)("select",{value:x,onChange:function(e){var t=e.target;return y(t.value)},children:s.map((function(e){return Object(l.jsx)("option",{value:e.value,children:e.label})}))})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Recipe"}),Object(l.jsx)("select",{value:P,onChange:function(e){var t=e.target;return E(t.value)},children:N.map((function(e){return Object(l.jsx)("option",{value:e.id,children:e.name})}))})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Assignee"}),Object(l.jsx)("select",{value:A.id,onChange:function(e){return function(e){var t=T.find((function(t){return t.id.toString()===e.toString()}));L(t)}(e.target.value)},children:T.map((function(e){return Object(l.jsx)("option",{value:e.id,children:e.first_name})}))})]}),Object(l.jsx)("button",{type:"submit",className:"submit-button",onClick:function(e){e.preventDefault();var a=N.find((function(e){return e.id.toString()===P.toString()}));if(a){var i={day:h,type:x.value?x.value:x,recipe_id:P,recipe_name:a.name,assigned_to:A.id,assigned_to_name:A.first_name,tag_color:A.tag_color};j?v.update(i,n.id).then((function(){i.id=n.id;var e=r.filter((function(e){return e.id!=n.id})).concat(i);c(e)})).catch((function(e){console.log("something went wrong with updating a meal",e)})):v.create(i).then((function(e){i.id=e[0].id;var t=r.concat(i);c(t)})).catch((function(e){console.log("something went wrong with creating a meal",e)})),o(!1)}else t("Cannot create a meal without a recipe. Please create a recipe first","error",5)},children:n.id?"Save changes":"Submit"}),n.id?Object(l.jsx)("button",{className:"delete-button",type:"delete",onClick:function(e){e.preventDefault(),v.remove(n.id).then((function(){var e=r.filter((function(e){return e.id!=n.id}));c(e),o(!1)})).catch((function(e){console.log("something went wrong with removing a meal",e)}))},children:"Delete"}):null]})]})})},C={weekdays:[{value:"monday"},{value:"tuesday"},{value:"wednesday"},{value:"thursday"},{value:"friday"},{value:"saturday"},{value:"sunday"}],meals:[{value:"lunch"},{value:"dinner"}],_getLabels:function(e){return this[e].map((function(e){return e.label=e.value.replace(/^\w{1}/,e.value[0].toUpperCase()),e}))},get weekdayLabels(){return this._getLabels("weekdays")},get mealLabels(){return this._getLabels("meals")}},N=function(e){var t=e.displayMessage,n=e.show,r=Object(a.useState)([]),c=Object(u.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)(!1),p=Object(u.a)(o,2),j=p[0],f=p[1],b=Object(a.useState)(""),h=Object(u.a)(b,2),m=h[0],g=h[1],x=C.weekdayLabels,w=C.mealLabels,y=function(e){e.preventDefault(),e.stopPropagation();var t=JSON.parse(e.dataTransfer.getData("text/plain")),n=i.find((function(e){return e.id===t.id})),a=JSON.parse(e.currentTarget.id);if(!i.some((function(e){return e.day===a.day&&e.type===a.meal.value}))){n.day=a.day,n.type=a.meal.value;var r=i.filter((function(e){return e.id!=n.id})).concat(n);s(r),v.update(n,n.id)}},S=function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move"},N=function(e){if(j)f(!1);else{var t=JSON.parse(e.currentTarget.id);g(t),f(!0)}};Object(a.useEffect)((function(){v.getAll().then((function(e){s(e)})).catch((function(e){t("We're having trouble retrieving your meal plan. Please try again later","error",5),console.log(e)}))}),[n]);var _={gridTemplateColumns:"3fr ".concat(x.map((function(e){return"5fr"})).join(" ")),gridTemplateRows:"50px ".concat(w.map((function(e){return"150px"})).join(" "))};return n?Object(l.jsxs)("div",{class:"calendar",style:_,children:[function(){var e=x.map((function(e){return e}));return e.unshift(""),e.map((function(e){return Object(l.jsx)("div",{className:"calendar-heading",id:e.value,children:e.label})}))}(),w.map((function(e){return function(e){var t=x.map((function(e){return e}));return t.unshift(e),t.map((function(n){return 0===t.indexOf(n)?Object(l.jsx)("div",{children:Object(l.jsx)("p",{children:n.label})}):Object(l.jsxs)("div",{className:"meal-slot",id:JSON.stringify({day:n.value,meal:{value:e.value,label:e.label}}),onDrop:y,onDragOver:S,onDoubleClick:N,children:[i.filter((function(t){return t.day===n.value&&t.type===e.value})).map((function(e){return Object(l.jsx)(d,{meal:e,toggleModal:N})})),Object(l.jsx)("span",{id:"create-new-meal",children:"Double click to create new meal"})]})}))}(e)})),Object(l.jsxs)(O.a,{isOpen:j,onRequestClose:N,contentLabel:"Uusi ateria",style:{content:{position:"fixed",zIndex:2,width:"50%",margin:"auto",height:"26rem"}},children:[Object(l.jsx)("span",{className:"modal-close",onClick:N,children:"X"}),Object(l.jsx)(k,{displayMessage:t,meal:m,meals:i,setMeals:s,weekdays:x,mealConfig:w,setIsOpen:f})]})]}):null},_=n(20),M=n(8),I="http://localhost:3000/api/ingredients",P={getAll:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.a.get("".concat(I)),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),get:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.get("".concat(I,"/").concat(t)),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.post("".concat(I),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},E="http://localhost:3000/api/units",R={getAll:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.a.get("".concat(E)),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),get:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.get("".concat(E,"/").concat(t)),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},D=n(33),A=function(e){var t=e.displayMessage,n=e.toggleModal,r=e.recipes,c=e.setRecipes,i=e.recipeID,s=Object(a.useState)(!0),o=Object(u.a)(s,2),d=o[0],p=o[1],j=Object(a.useState)(i?r.find((function(e){return e.id==i})):null),f=Object(u.a)(j,2),b=f[0],h=(f[1],Object(a.useState)()),m=Object(u.a)(h,2),v=m[0],g=m[1],O=Object(a.useState)([]),x=Object(u.a)(O,2),y=x[0],S=x[1],k=Object(a.useState)([]),C=Object(u.a)(k,2),N=C[0],I=C[1],E=Object(a.useState)([]),A=Object(u.a)(E,2),L=A[0],U=A[1],J=Object(a.useState)(""),T=Object(u.a)(J,2),q=T[0],W=T[1],F=Object(a.useState)(""),z=Object(u.a)(F,2),B=z[0],X=z[1];Object(a.useEffect)((function(){R.getAll().then((function(e){S(e)})).catch((function(e){console.log(e)})),P.getAll().then((function(e){var t=e.map((function(e){return{value:e.value,label:e.label,quantity:1,unit:"tl"}}));U(t)})).catch((function(e){console.log(e),t("Something went wrong with fetching ingredients","error",5)})),b&&(p(!1),g(b.name),W(b.preparation_time),X(b.instructions),w.getIngredients(b.id).then((function(e){I(e)})).catch((function(e){console.log(e),t("Something went wrong with fetching ingredients","error",5)})))}),[b]);return d?Object(l.jsx)("div",{className:"form-container",children:Object(l.jsxs)("div",{className:"form-wrapper",id:"recipe-form-wrapper",children:[Object(l.jsx)("h2",{children:b?"Edit recipe":"Create new recipe"}),Object(l.jsxs)("form",{className:"recipe-form",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Name"}),Object(l.jsx)("input",{style:{width:520},id:"recipe-name",type:"text",value:v,onChange:function(e){var t=e.target;return g(t.value)}})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Preparation time"}),Object(l.jsx)("input",{style:{width:100},id:"preparation-time",type:"number",value:q,onChange:function(e){var t=e.target;return W(t.value)}})," min"]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Ingredients"}),Object(l.jsx)(D.a,{id:"ingredients-picker",onCreateOption:function(e){var n={name:e};P.create(n).then((function(e){var t={value:e[0].id,label:e[0].name,quantity:1,unit:"tl"};U([].concat(Object(_.a)(L),[t])),I([].concat(Object(_.a)(N),[t]))})).catch((function(e){console.log(e),t("Something went wrong with creating a new ingredient","error",5)}))},onChange:I,value:N,placeholder:"Search ingredients",options:L,isMulti:!0,isSearchable:!0})]}),Object(l.jsx)("div",{children:Object(l.jsx)("ul",{style:{listStyle:"none"},children:N.map((function(e){return Object(l.jsxs)("li",{style:{width:"60%",borderBottom:"1px solid gray",margin:"0.5rem 0 0.5rem 0"},children:[Object(l.jsx)("input",{type:"number",style:{border:"none",width:"3rem",marginRight:"5px"},step:"0.1",id:e.value,value:e.quantity,className:"quantity-input",onChange:function(e){return function(e){var t=N.map((function(t){return t.value==e.id?Object(M.a)(Object(M.a)({},t),{},{quantity:parseFloat(e.value)}):t}));I(t)}(e.target)}}),Object(l.jsx)("select",{className:"unit-input",id:e.value,style:{border:"none",width:"2.5rem",paddingLeft:"0.5rem",marginRight:"5px",webkitAppearance:"none"},value:e.unit,onChange:function(e){return function(e){var t=N.map((function(t){return t.value==e.id?Object(M.a)(Object(M.a)({},t),{},{unit:e.value}):t}));I(t)}(e.target)},children:y.map((function(e){return Object(l.jsx)("option",{value:e.name,children:e.name})}))}),e.label]},e.value)}))})}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Instructions"}),Object(l.jsx)("textarea",{id:"instructions",rows:"15",cols:"70",value:B,onChange:function(e){var t=e.target;return X(t.value)}})]}),Object(l.jsx)("button",{className:"submit-button",type:"submit",onClick:function(e){e.preventDefault();var a={name:v,ingredients:N,instructions:B,duration:Number(q)};i?function(e,a){w.update(e,a).then((function(e){var a=r.filter((function(t){return t.id!=e[0].id})).concat(e[0]);c(a),g(e[0].name),W(e[0].preparation_time),X(e[0].instructions),n(),t('Saved changes to "'.concat(e[0].name,'"'),"success",5)})).catch((function(e){console.log(e),t("Something went wrong with saving the recipe","error",5)}))}(i,a):function(e){w.create(e).then((function(e){c(r.concat(e[0])),g(""),I([]),W(""),X(""),n(),t('Created new recipe "'.concat(e[0].name,'"'),"success",5)})).catch((function(e){console.log(e),t("Something went wrong with saving the recipe","error",5)}))}(a)},children:"Save"}),i?Object(l.jsx)("button",{className:"delete-button",onClick:function(e){return function(e,a){e.preventDefault(),w.remove(a).then((function(e){var i=r.filter((function(e){return e.id!=a}));c(i),t("Recipe deleted","success",5),n()})).catch((function(e){console.log(e),t("Failed deleting recipe","error",5)}))}(e,i)},children:"Delete"}):null]})]})}):Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:b.name}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Preparation time:"})," ",b.preparation_time]}),Object(l.jsx)("div",{children:Object(l.jsx)("ul",{children:N.map((function(e){return Object(l.jsxs)("li",{children:[e.quantity," ",e.unit," ",e.label]})}))})}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Instructions:"})," ",b.instructions]}),Object(l.jsx)("button",{id:"edit-recipe-button",onClick:function(){return p(!0)},children:"Edit"})]})},L=function(e){return Object(l.jsxs)(O.a,{isOpen:e.isOpen,onRequestClose:e.toggleModal,shouldCloseOnOverlayClick:!0,contentLabel:e.label,style:e.style,onAfterClose:function(){return e.selectRecipe("")},children:[Object(l.jsx)("span",{className:"modal-close",onClick:e.toggleModal,children:"X"}),Object(l.jsx)(A,{displayMessage:e.displayMessage,toggleModal:e.toggleModal,recipes:e.recipes,setRecipes:e.setRecipes,recipeID:e.selectedRecipe})]})},U=function(e){var t=e.recipe,n=e.selectRecipe,a=e.toggleModal,r=o;return Object(l.jsxs)("li",{class:"recipes-list-card",id:t.id,onClick:function(e){var t=e.currentTarget;n(t.id),a()},children:[Object(l.jsx)("b",{children:r(t.name,30)}),Object(l.jsxs)("div",{className:"recipe-list-card-details",children:["Preparation time: ",t.preparation_time," min"]}),Object(l.jsx)("span",{className:"edit-recipe",children:"Click to view"})]},t.id)},J=function(e){var t=e.show,n=e.displayMessage,r=e.toggleModal,c=e.isOpen,i=Object(a.useState)([]),s=Object(u.a)(i,2),o=s[0],d=s[1],p=Object(a.useState)(""),j=Object(u.a)(p,2),f=j[0],b=j[1],h=Object(a.useState)(""),m=Object(u.a)(h,2),v=m[0],g=m[1];return Object(a.useEffect)((function(){w.getAll().then((function(e){d(e)})).catch((function(e){console.log(e),n("We're having trouble fetching recipes. Please try again later","error",5)}))}),[t]),t?Object(l.jsxs)("div",{children:[Object(l.jsx)(L,{isOpen:c,toggleModal:r,label:"recipe form",style:{content:{width:"50%",margin:"auto",height:"auto"}},selectRecipe:b,selectedRecipe:f,recipes:o,setRecipes:d,displayMessage:n}),Object(l.jsx)("input",{type:"text",className:"search-box",placeholder:"Search recipes",onChange:function(e){var t=e.target;return g(t.value.toLowerCase())}}),Object(l.jsx)("button",{style:{marginLeft:"1rem"},id:"create-recipe",onClick:function(){return r()},children:"Create new recipe"}),Object(l.jsx)("ul",{className:"recipes-list-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(190px, 1fr))",gridGap:"0.2rem"},children:o.filter((function(e){return-1!=e.name.toLowerCase().indexOf(v)})).map((function(e){return Object(l.jsx)(U,{recipe:e,selectRecipe:b,toggleModal:r})}))})]}):null},T=function(e){var t=e.message;return t?Object(l.jsx)("div",{className:"message-banner banner-".concat(t.type),children:t.content}):null},q="http://localhost:3000/api/auth",W={register:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.post("".concat(q,"/register"),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),login:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.post("".concat(q,"/login"),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.a.post("".concat(q,"/logout")),e.abrupt("return",t.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),resetPassword:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.a.put("".concat(q,"/reset_password"),t),e.abrupt("return",n.then((function(e){return e.data})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},F=function(e){var t=e.show,n=e.setUser,r=e.setPage,c=e.displayMessage,i=Object(a.useState)(""),s=Object(u.a)(i,2),o=s[0],d=s[1],p=Object(a.useState)(""),j=Object(u.a)(p,2),f=j[0],b=j[1];return t?Object(l.jsx)("div",{className:"form-container",children:Object(l.jsx)("div",{className:"form-wrapper",id:"login-form-wrapper",children:Object(l.jsxs)("form",{id:"login-form",onSubmit:function(e){e.preventDefault(),W.login({username:o,password:f}).then((function(e){c(" Successfully logged in as ".concat(e.name),"success",5),window.localStorage.setItem("loggedInUser",JSON.stringify(e)),n(e),d(""),b(""),r("weekly-calendar")})).catch((function(e){c("Incorrect username or password","error",5)}))},children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"username"}),Object(l.jsx)("input",{id:"username",type:"text",value:o,name:"username",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"password"}),Object(l.jsx)("input",{id:"password",type:"password",value:f,name:"Password",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(l.jsx)("button",{id:"login-button",type:"submit",children:"login"})]})})}):null},z=function(e){var t=e.show,n=(e.user,e.setUser),r=e.setPage,c=e.displayMessage,i=Object(a.useState)(""),s=Object(u.a)(i,2),o=s[0],d=s[1],p=Object(a.useState)(""),j=Object(u.a)(p,2),f=j[0],b=j[1],h=Object(a.useState)(""),m=Object(u.a)(h,2),v=m[0],g=m[1],O=Object(a.useState)(""),x=Object(u.a)(O,2),w=x[0],y=x[1];return t?Object(l.jsx)("div",{className:"form-container",children:Object(l.jsx)("div",{className:"form-wrapper",id:"login-form-wrapper",children:Object(l.jsxs)("form",{id:"sign-up-form",onSubmit:function(e){e.preventDefault();var t={username:o,firstName:f,email:v,password:w};W.register(t).then((function(e){c("Welcome ".concat(e.name,"! You are now logged in"),"success",5),window.localStorage.setItem("loggedInUser",JSON.stringify(e)),n(e),d(""),y(""),b(""),g(""),r("weekly-calendar")})).catch((function(e){c("Registration failed: ".concat(e.response.data.message),"error",5),console.log(e)}))},children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Username"}),Object(l.jsx)("input",{id:"username",type:"text",value:o,name:"username",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"First name"}),Object(l.jsx)("input",{id:"first-name",type:"text",value:f,name:"firstName",onChange:function(e){var t=e.target;return b(t.value)}})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Email"}),Object(l.jsx)("input",{id:"email",type:"email",value:v,name:"email",onChange:function(e){var t=e.target;return g(t.value)}})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Password"}),Object(l.jsx)("input",{id:"password",type:"password",value:w,name:"Password",onChange:function(e){var t=e.target;return y(t.value)}})]}),Object(l.jsx)("button",{id:"sign-up-button",type:"submit",children:"Create account"})]})})}):null},B=function(e){var t=e.show,n=e.displayMessage,r=Object(a.useState)({}),c=Object(u.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)({}),d=Object(u.a)(o,2),p=d[0],j=d[1],f=Object(a.useState)({}),b=Object(u.a)(f,2),h=b[0],m=b[1],v=function(e){e.target.previousElementSibling.disabled=!1;var t=Object(M.a)({},h);t[e.target.parentElement.id]=!0,m(t)},g=function(e){var t=e.target.name,n=e.target.value,a=Object(M.a)({},i);a[t].value=n,s(a)},O=function(e){e.target.previousElementSibling.disabled=!0;var t=e.target.parentElement.id,a=p[t].value,r=i[t].value,c=Object(M.a)({},h);if(c[t]=!1,m(c),a){var u={field_name:t,value:r};"password"===t?W.resetPassword({new_password:r}).then((function(e){var t=Object(M.a)(Object(M.a)({},p),{},{password:e.password});j(t),s(t),n("Password changed","success",5)})).catch((function(e){n(e.response.data.message,"error",5);var t=Object(M.a)(Object(M.a)({},i),{},{password:a});s(t),console.log(e.message)})):S.update(x.id,u).then((function(){j(i),n("Saved changes","success",5)})).catch((function(e){console.log(e)}))}},x=JSON.parse(window.localStorage.getItem("loggedInUser"));if(Object(a.useEffect)((function(){x&&x.id&&S.get(x.id).then((function(e){var t={first_name:{value:e.first_name},username:{value:e.username},password:{value:e.password},email:{value:e.email},household_name:{value:e.household_name}};s(t),j(t)})).catch((function(e){console.log(e)}))}),[t]),t){var w=i.first_name,y=i.username,k=i.password,C=i.email,N=i.household_name;return Object(l.jsx)("div",{className:"form-container",children:Object(l.jsx)("div",{className:"form-wrapper",children:Object(l.jsxs)("form",{children:[Object(l.jsxs)("div",{id:"first_name",children:[Object(l.jsx)("label",{children:Object(l.jsx)("b",{children:"Name:"})})," ",Object(l.jsx)("input",{className:"account",name:"first_name",onChange:function(e){return g(e)},value:w?w.value:null,disabled:!0}),h.first_name?null:Object(l.jsx)("span",{className:"edit-save-field",id:"edit_firstName",onClick:function(e){return v(e)},children:"Edit"}),h.first_name?Object(l.jsx)("span",{className:"edit-save-field",id:"save_firstName",onClick:function(e){return O(e)},children:"Save"}):null]}),Object(l.jsxs)("div",{id:"username",children:[Object(l.jsx)("label",{children:Object(l.jsx)("b",{children:"Username:"})})," ",Object(l.jsx)("input",{className:"account",name:"username",value:y?y.value:null,disabled:!0})]}),Object(l.jsxs)("div",{id:"password",children:[Object(l.jsx)("label",{children:Object(l.jsx)("b",{children:"Password:"})})," ",Object(l.jsx)("input",{className:"account",name:"password",type:"password",onChange:function(e){return g(e)},value:k?k.value:null,disabled:!0}),h.password?null:Object(l.jsx)("span",{className:"edit-save-field",id:"edit_password",onClick:function(e){return v(e)},children:"Edit"}),h.password?Object(l.jsx)("span",{className:"edit-save-field",id:"save_password",onClick:function(e){return O(e)},children:"Save"}):null]}),Object(l.jsxs)("div",{id:"email",children:[Object(l.jsx)("label",{children:Object(l.jsx)("b",{children:"Email:"})})," ",Object(l.jsx)("input",{className:"account",name:"email",onChange:function(e){return g(e)},value:C?C.value:null,disabled:!0}),h.email?null:Object(l.jsx)("span",{className:"edit-save-field",id:"edit_email",onClick:function(e){return v(e)},children:"Edit"}),h.email?Object(l.jsx)("span",{className:"edit-save-field",id:"save_email",onClick:function(e){return O(e)},children:"Save"}):null]}),Object(l.jsxs)("div",{id:"email",children:[Object(l.jsx)("label",{children:Object(l.jsx)("b",{children:"Household name:"})})," ",Object(l.jsx)("input",{className:"account",name:"household_name",onChange:function(e){return g(e)},value:N?N.value:null,disabled:!0})]})]})})})}return null},X=n(32),G=n(0),H=function(){var e=Object(a.useState)("weekly-calendar"),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),i=Object(u.a)(c,2),o=i[0],d=i[1],p=Object(a.useState)(!1),j=Object(u.a)(p,2),f=j[0],b=j[1],h=Object(a.useState)(null),m=Object(u.a)(h,2),v=m[0],g=m[1],O=function(e,t,n){d({content:e,type:t}),setTimeout((function(){d("")}),1e3*n)};Object(a.useEffect)((function(){var e=JSON.parse(window.localStorage.getItem("loggedInUser"));e?g(e):r("login")}),[]);return Object(l.jsxs)("div",{children:[Object(l.jsxs)("header",{children:[Object(l.jsxs)("div",{className:"navbar",children:[Object(l.jsxs)("ul",{className:"nav",children:[v?Object(l.jsx)("li",{id:"weekly-calendar",className:"brand",onClick:function(){return r("weekly-calendar")},children:"Weekly planner"}):null,v?Object(l.jsx)("li",{id:"all-recipes",onClick:function(){return r("recipes")},children:"Recipes"}):null]}),v?Object(l.jsxs)("ul",{className:"nav",children:[Object(l.jsxs)("li",{onClick:function(){return r("account")},children:[Object(l.jsx)(G.b.Provider,{value:{size:"1.5rem"},children:Object(l.jsx)(X.a,{style:{marginRight:"0.5rem"}})}),"My Account"]}),Object(l.jsx)("li",{className:"auth",id:"logout",onClick:function(){W.logout().then((function(e){window.localStorage.removeItem("loggedInUser"),g(null),r("login"),O("Successfully logged out","success",5)}))},children:"Logout "}),"a"]}):Object(l.jsxs)("ul",{className:"nav",children:[Object(l.jsx)("li",{className:"auth",id:"login",onClick:function(){return r("login")},children:"Login"}),Object(l.jsx)("li",{className:"auth",id:"sign-up",onClick:function(){return r("sign-up")},children:"Sign up"})]})]}),Object(l.jsx)(T,{message:o})]}),Object(l.jsx)(J,{show:"recipes"===n,message:o,displayMessage:O,toggleModal:function(){b(!f)},isOpen:f}),Object(l.jsx)(N,{show:"weekly-calendar"===n,displayMessage:O}),Object(l.jsx)(F,Object(s.a)({setPage:r,show:"login"===n,displayMessage:O,setUser:g},"setPage",r)),Object(l.jsx)(z,{show:"sign-up"===n,displayMessage:O,user:v,setUser:g,setPage:r}),Object(l.jsx)(B,{loggedInUser:v,show:"account"===n,displayMessage:O})]})};i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(H,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.132592c9.chunk.js.map